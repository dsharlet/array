<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>array: include/array/ein_reduce.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">array
   </div>
   <div id="projectbrief">C++ library for multi-dimensional arrays</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_717b3188b45e89f652d81ea10aa11b1d.html">array</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ein_reduce.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Optional helper for computing Einstein reductions on arrays.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="array_8h_source.html">array/array.h</a>&quot;</code><br />
</div>
<p><a href="ein__reduce_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad5c3b9c8dee476d4f06c47949cf4262a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>NDARRAY_MAKE_EIN_BINARY_HELPERS</b>(name,  op)</td></tr>
<tr class="separator:ad5c3b9c8dee476d4f06c47949cf4262a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b02e6ad1d71d6bbbc495194a71f7925"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>NDARRAY_MAKE_EIN_BINARY_OP</b>(name,  op,  is_assign_)</td></tr>
<tr class="separator:a9b02e6ad1d71d6bbbc495194a71f7925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0172b6a55b2d163d5e7008adbdf8f1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>NDARRAY_MAKE_EIN_BINARY_FN</b>(name,  fn)</td></tr>
<tr class="separator:a4e0172b6a55b2d163d5e7008adbdf8f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a04504a9b60455f3e094c1ef92e0caece"><td class="memTemplParams" colspan="2">template&lt;class Type , class Op &gt; </td></tr>
<tr class="memitem:a04504a9b60455f3e094c1ef92e0caece"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#a04504a9b60455f3e094c1ef92e0caece">cast</a> (const internal::ein_op_base&lt; Op &gt; &amp;op)</td></tr>
<tr class="separator:a04504a9b60455f3e094c1ef92e0caece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbf4a1e9bc0aad43e7db974ef620d10d"><td class="memTemplParams" colspan="2">template&lt;class OpA , class OpB &gt; </td></tr>
<tr class="memitem:adbf4a1e9bc0aad43e7db974ef620d10d"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#adbf4a1e9bc0aad43e7db974ef620d10d">min</a> (const internal::ein_op_base&lt; OpA &gt; &amp;a, const internal::ein_op_base&lt; OpB &gt; &amp;b)</td></tr>
<tr class="separator:adbf4a1e9bc0aad43e7db974ef620d10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b7f22d262fe35cf9f9bc06ddfa1457"><td class="memTemplParams" colspan="2"><a class="anchor" id="a07b7f22d262fe35cf9f9bc06ddfa1457"></a>
template&lt;class OpA , class OpB &gt; </td></tr>
<tr class="memitem:a07b7f22d262fe35cf9f9bc06ddfa1457"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><b>max</b> (const internal::ein_op_base&lt; OpA &gt; &amp;a, const internal::ein_op_base&lt; OpB &gt; &amp;b)</td></tr>
<tr class="separator:a07b7f22d262fe35cf9f9bc06ddfa1457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa6163421edd4ccbbc3da74c6505e7d"><td class="memTemplParams" colspan="2">template&lt;size_t... Is, class Op , class  = internal::enable_if_callable&lt;Op, decltype(Is)...&gt;&gt; </td></tr>
<tr class="memitem:a5aa6163421edd4ccbbc3da74c6505e7d"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#a5aa6163421edd4ccbbc3da74c6505e7d">ein</a> (Op op)</td></tr>
<tr class="separator:a5aa6163421edd4ccbbc3da74c6505e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af23720d880274e6a9a706f73c3afe426"><td class="memTemplParams" colspan="2"><a class="anchor" id="af23720d880274e6a9a706f73c3afe426"></a>
template&lt;size_t... Is, class T , class Shape , class Alloc , class  = std::enable_if_t&lt;sizeof...(Is) == Shape::rank()&gt;&gt; </td></tr>
<tr class="memitem:af23720d880274e6a9a706f73c3afe426"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><b>ein</b> (array&lt; T, Shape, Alloc &gt; &amp;op)</td></tr>
<tr class="separator:af23720d880274e6a9a706f73c3afe426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a822b3322b95c22582670dd7d623f09e2"><td class="memTemplParams" colspan="2"><a class="anchor" id="a822b3322b95c22582670dd7d623f09e2"></a>
template&lt;size_t... Is, class T , class Shape , class Alloc , class  = std::enable_if_t&lt;sizeof...(Is) == Shape::rank()&gt;&gt; </td></tr>
<tr class="memitem:a822b3322b95c22582670dd7d623f09e2"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><b>ein</b> (const array&lt; T, Shape, Alloc &gt; &amp;op)</td></tr>
<tr class="separator:a822b3322b95c22582670dd7d623f09e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f688a219c0e3e3505fd362314dfdce8"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a6f688a219c0e3e3505fd362314dfdce8"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#a6f688a219c0e3e3505fd362314dfdce8">ein</a> (T &amp;scalar)</td></tr>
<tr class="separator:a6f688a219c0e3e3505fd362314dfdce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acec822fa92f9c968aa1e06618b1ba5f7"><td class="memTemplParams" colspan="2">template&lt;size_t I0, class T &gt; </td></tr>
<tr class="memitem:acec822fa92f9c968aa1e06618b1ba5f7"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#acec822fa92f9c968aa1e06618b1ba5f7">ein</a> (T *x, size_t N)</td></tr>
<tr class="separator:acec822fa92f9c968aa1e06618b1ba5f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3f1b7ac8f4a0ed403a92dc6e9274d6"><td class="memTemplParams" colspan="2">template&lt;size_t I0, class T , size_t N&gt; </td></tr>
<tr class="memitem:a2c3f1b7ac8f4a0ed403a92dc6e9274d6"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#a2c3f1b7ac8f4a0ed403a92dc6e9274d6">ein</a> (T(&amp;x)[N])</td></tr>
<tr class="separator:a2c3f1b7ac8f4a0ed403a92dc6e9274d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a5162bd8e63b8ca47f92b1db361f187"><td class="memTemplParams" colspan="2">template&lt;class Expr , class  = internal::enable_if_ein_assign&lt;Expr&gt;&gt; </td></tr>
<tr class="memitem:a9a5162bd8e63b8ca47f92b1db361f187"><td class="memTemplItemLeft" align="right" valign="top">NDARRAY_INLINE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#a9a5162bd8e63b8ca47f92b1db361f187">ein_reduce</a> (const Expr &amp;expr)</td></tr>
<tr class="separator:a9a5162bd8e63b8ca47f92b1db361f187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7689fd5b57271dccb3d2d89f6c82d7c3"><td class="memTemplParams" colspan="2">template&lt;size_t... ResultIs, class Expr , class  = internal::enable_if_ein_op&lt;Expr&gt;&gt; </td></tr>
<tr class="memitem:a7689fd5b57271dccb3d2d89f6c82d7c3"><td class="memTemplItemLeft" align="right" valign="top">NDARRAY_UNIQUE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#a7689fd5b57271dccb3d2d89f6c82d7c3">make_ein_reduce_shape</a> (const Expr &amp;expr)</td></tr>
<tr class="separator:a7689fd5b57271dccb3d2d89f6c82d7c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05e87f38452d1e7015eec619dcfb502"><td class="memTemplParams" colspan="2">template&lt;class T , size_t... ResultIs, class Expr , class Alloc  = std::allocator&lt;T&gt;, class  = internal::enable_if_ein_op&lt;Expr&gt;&gt; </td></tr>
<tr class="memitem:af05e87f38452d1e7015eec619dcfb502"><td class="memTemplItemLeft" align="right" valign="top">NDARRAY_INLINE auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="ein__reduce_8h.html#af05e87f38452d1e7015eec619dcfb502">make_ein_sum</a> (const Expr &amp;expr, const T &amp;init=T(), const Alloc &amp;alloc=Alloc())</td></tr>
<tr class="separator:af05e87f38452d1e7015eec619dcfb502"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Optional helper for computing Einstein reductions on arrays. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ad5c3b9c8dee476d4f06c47949cf4262a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDARRAY_MAKE_EIN_BINARY_HELPERS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">op&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> OpA, <span class="keyword">class</span> OpB&gt;                                                                  \</div><div class="line">  auto make_##name(<span class="keyword">const</span> OpA&amp; a, <span class="keyword">const</span> OpB&amp; b) {                                                   \</div><div class="line">    return name&lt;OpA, OpB&gt;(a, b);                                                                   \</div><div class="line">  }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9b02e6ad1d71d6bbbc495194a71f7925"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDARRAY_MAKE_EIN_BINARY_OP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">op, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">is_assign_&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> OpA, <span class="keyword">class</span> OpB&gt;                                                                  \</div><div class="line">  struct name : <span class="keyword">public</span> ein_binary_op&lt;OpA, OpB, name&lt;OpA, OpB&gt;&gt; {                                   \</div><div class="line">    using base = ein_binary_op&lt;OpA, OpB, name&gt;;                                                    \</div><div class="line">    name(<span class="keyword">const</span> OpA&amp; a, <span class="keyword">const</span> OpB&amp; b) : base(a, b) {}                                               \</div><div class="line">    using is_assign = is_assign_;                                                                  \</div><div class="line">    template &lt;class Idx&gt;                                                                           \</div><div class="line">    NDARRAY_INLINE <span class="keyword">auto</span> operator()(<span class="keyword">const</span> Idx&amp; i)<span class="keyword"> const </span>{                                           \</div><div class="line">      return base::op_a(i) op base::op_b(i);                                                       \</div><div class="line">    }                                                                                              \</div><div class="line">  };                                                                                               \</div><div class="line">  NDARRAY_MAKE_EIN_BINARY_HELPERS(name, op)</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e0172b6a55b2d163d5e7008adbdf8f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDARRAY_MAKE_EIN_BINARY_FN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fn&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> OpA, <span class="keyword">class</span> OpB&gt;                                                                  \</div><div class="line">  struct name : <span class="keyword">public</span> ein_binary_op&lt;OpA, OpB, name&lt;OpA, OpB&gt;&gt; {                                   \</div><div class="line">    using base = ein_binary_op&lt;OpA, OpB, name&gt;;                                                    \</div><div class="line">    name(<span class="keyword">const</span> OpA&amp; a, <span class="keyword">const</span> OpB&amp; b) : base(a, b) {}                                               \</div><div class="line">    template &lt;class Idx&gt;                                                                           \</div><div class="line">    NDARRAY_INLINE <span class="keyword">auto</span> operator()(<span class="keyword">const</span> Idx&amp; i)<span class="keyword"> const </span>{                                           \</div><div class="line">      using internal::min;                                                                              \</div><div class="line">      using internal::max;                                                                              \</div><div class="line">      return fn(base::op_a(i), base::op_b(i));                                                     \</div><div class="line">    }                                                                                              \</div><div class="line">  };                                                                                               \</div><div class="line">  NDARRAY_MAKE_EIN_BINARY_HELPERS(name, op)</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="file_a04504a9b60455f3e094c1ef92e0caece"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto nda::cast </td>
          <td>(</td>
          <td class="paramtype">const internal::ein_op_base&lt; Op &gt; &amp;&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cast an Einstein summation operand to a different type <code>Type</code>. The cast is performed using <code>static_cast&lt;Type&gt;</code>. </p>

</div>
</div>
<a class="anchor" id="file_adbf4a1e9bc0aad43e7db974ef620d10d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto nda::min </td>
          <td>(</td>
          <td class="paramtype">const internal::ein_op_base&lt; OpA &gt; &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const internal::ein_op_base&lt; OpB &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The min or max of two Einstein summation operands. </p>

</div>
</div>
<a class="anchor" id="file_a5aa6163421edd4ccbbc3da74c6505e7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto nda::ein </td>
          <td>(</td>
          <td class="paramtype">Op&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Operand for an Einstein summation, which is an array or other callable object, along with a set of dimension indices. <code>ein&lt;i, j, ...&gt;(a)</code> means the dimensions <code>i, j, ...</code> of the summation index are used to address <code>a</code> during Einstein summation. The number of dimensions must match the number of arguments of <code>a</code>. See <code><a class="el" href="ein__reduce_8h.html#a9a5162bd8e63b8ca47f92b1db361f187">ein_reduce()</a></code> for more details. </p>

</div>
</div>
<a class="anchor" id="file_a6f688a219c0e3e3505fd362314dfdce8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto nda::ein </td>
          <td>(</td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>scalar</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define an Einstein summation operand for a scalar. The scalar is broadcasted as needed during the summation. Because this operand does not provide a shape, the dimensions of the sum must be inferred from other operands. See <code><a class="el" href="ein__reduce_8h.html#a9a5162bd8e63b8ca47f92b1db361f187">ein_reduce()</a></code> for more details. </p>

</div>
</div>
<a class="anchor" id="file_acec822fa92f9c968aa1e06618b1ba5f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto nda::ein </td>
          <td>(</td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define an Einstein summation operand for a pointer and size. </p>

</div>
</div>
<a class="anchor" id="file_a2c3f1b7ac8f4a0ed403a92dc6e9274d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto nda::ein </td>
          <td>(</td>
          <td class="paramtype">T(&amp;)&#160;</td>
          <td class="paramname"><em>x</em>[N]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define an Einstein summation operand for a C array. </p>

</div>
</div>
<a class="anchor" id="file_a9a5162bd8e63b8ca47f92b1db361f187"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NDARRAY_INLINE auto nda::ein_reduce </td>
          <td>(</td>
          <td class="paramtype">const Expr &amp;&#160;</td>
          <td class="paramname"><em>expr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute an Einstein reduction. This function allows one to specify many kinds of array transformations and reductions using <a href="https://en.wikipedia.org/wiki/Einstein_notation">Einstein notation</a>.</p>
<p>This function accepts an expression <code>expr</code> constructed using operators on <code>ein&lt;i, j, ...&gt;(op)</code> operands. These operands describe which dimensions of the reduction index should be used to address that operand. The rank of the reduction operation is inferred from the number of dimensions used in the expression. The reduction operation is executed in the order of the indices, with the lowest numbered dimension executed as the innermost loop.</p>
<p>If <code>expr</code> is a reduction operator, the result must be initialized to some useful value, typically the identity value for the reduction operator, e.g. <code>0</code> for <code>+=</code>. Not initializing the result allows successive <code>ein_reduce</code> operations to be applied to the same result.</p>
<p>This function does not optimize the associative order in which the operations are performed. It evaluates the expression for each element of the final result reduction. This can be efficient for expansion operations, but it may be inefficient for contractions. Contractions may need to be reassociated manually for efficient computation.</p>
<p>This function does not optimize the loop ordering within each operation. The goal of this function is to provide a low-overhead and expressive reduction that can be composed with other explicit loop transformations to achieve good performance. Various optimization strategies can be implemented by splitting loops appropriately and by controlling the order of the loops with the reduction indices.</p>
<p>Examples:</p><ul>
<li><code>ein_reduce(ein&lt;&gt;(tr_A) += ein&lt;i, i&gt;(A))</code>, the trace of <code>A</code>.</li>
<li><code>ein_reduce(ein&lt;&gt;(dot) += (ein&lt;i&gt;(x) + ein&lt;i&gt;(y)) * ein&lt;i&gt;(z))</code>, the dot product <code>(x + y)*z</code>.</li>
<li><code>ein_reduce(ein&lt;i, j&gt;(AB) += ein&lt;i, k&gt;(A) * ein&lt;k, j&gt;(B))</code>, the matrix product <code>A*B</code></li>
<li><code>ein_reduce(ein&lt;i&gt;(Ax) += ein&lt;i, j&gt;(A) * ein&lt;j&gt;(x))</code>, the matrix-vector product <code>A*x</code></li>
<li><code>ein_reduce(ein&lt;i&gt;(diag_A) = ein&lt;i, i&gt;(A))</code>, the diagonal of <code>A</code>.</li>
</ul>
<p>where:</p><ul>
<li><code>A</code>, <code>B</code>, <code>AB</code> are matrices (rank 2 arrays)</li>
<li><code>x</code>, <code>y</code>, <code>z</code>, <code>Ax</code> are vectors (rank 1 arrays)</li>
<li><code>tr_A</code>, <code>dot</code> are scalar (rank 0 arrays)</li>
<li><code>i</code>, <code>j</code>, <code>k</code> are unique constexpr integers. </li>
</ul>

</div>
</div>
<a class="anchor" id="file_a7689fd5b57271dccb3d2d89f6c82d7c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NDARRAY_UNIQUE auto nda::make_ein_reduce_shape </td>
          <td>(</td>
          <td class="paramtype">const Expr &amp;&#160;</td>
          <td class="paramname"><em>expr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Infer the shape of the result of <code>make_ein_reduce</code>. </p>

</div>
</div>
<a class="anchor" id="file_af05e87f38452d1e7015eec619dcfb502"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NDARRAY_INLINE auto nda::make_ein_sum </td>
          <td>(</td>
          <td class="paramtype">const Expr &amp;&#160;</td>
          <td class="paramname"><em>expr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>init</em> = <code>T()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Alloc &amp;&#160;</td>
          <td class="paramname"><em>alloc</em> = <code>Alloc()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute an Einstein summation using <code>ein_reduce</code> and return the result. The <code>value_type</code> of the result will be <code>T</code>, and the result shape will be inferred from the shape of the operands. The result is initialized to <code>init</code> prior to computing the summation. The Einstein summation indices for the result operand are <code>ResultIs...</code>.</p>
<p>Examples:</p><ul>
<li><code>trace_A = make_ein_sum&lt;T&gt;(ein&lt;i, i&gt;(A))</code></li>
<li><code>dot = make_ein_sum&lt;T&gt;((ein&lt;i&gt;(x) + ein&lt;i&gt;(y)) * ein&lt;i&gt;(z))</code></li>
<li><code>AB = make_ein_sum&lt;T, i, j&gt;(ein&lt;i, k&gt;(A) * ein&lt;k, j&gt;(B))</code></li>
<li><code>Ax = make_ein_sum&lt;T, i&gt;(ein&lt;i, j&gt;(A) * ein&lt;1&gt;(x))</code></li>
</ul>
<p>where:</p><ul>
<li><code>A</code>, <code>B</code> are matrices (rank 2 arrays)</li>
<li><code>x</code>, <code>y</code>, <code>z</code> are vectors (rank 1 arrays)</li>
<li><code>i</code>, <code>j</code>, <code>k</code> are unique constexpr integers.</li>
</ul>
<p>See <code><a class="el" href="ein__reduce_8h.html#a9a5162bd8e63b8ca47f92b1db361f187">ein_reduce()</a></code> for more details. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
